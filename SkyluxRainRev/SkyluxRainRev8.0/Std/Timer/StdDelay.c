/**********************************************************************************************************************/
/**
 * @file        timer\StdDelay.c
 *
 * @author      Stijn Vermeersch
 * @date        27.05.2019
 *
 * @brief       
 *
 *
 * \n<hr>
 * Copyright (c) 2019, S-tronics\n
 * All rights reserved.
 * \n<hr>\n
 */
/**********************************************************************************************************************/

/**********************************************************************************************************************/



/***********************************************************************************************************************
; V E R I F Y    C O N F I G U R A T I O N
;---------------------------------------------------------------------------------------------------------------------*/

/*--------------------------------------------------------------------------------------------------------------------*/
/**
 * @brief  Defines the max number of tasks one wants to support
 */
//#ifndef TASK_COUNT
//    #error "TASK_COUNT not defined in AppConfig.h"
//#endif
/**********************************************************************************************************************/



/***********************************************************************************************************************
; I N C L U D E S
;---------------------------------------------------------------------------------------------------------------------*/
#include <stdbool.h>
#include <peripheral_clk_config.h>
#include <utils.h>
#include <hal_init.h>
#include <hal_timer.h>
#include <hpl_tc_base.h>
#include <hpl_timer.h>
#include <hpl_gclk_base.h>
#include <hpl_pm_base.h>

//DRIVER lib include section

//STANDARD lib include section
#include "StdDelay.h"
/**********************************************************************************************************************/



/***********************************************************************************************************************
; L O C A L   D E F I N I T I O N S   A N D   M A C R O S
;---------------------------------------------------------------------------------------------------------------------*/


/**********************************************************************************************************************/



/***********************************************************************************************************************
; L O C A L   T Y P E D E F S
;---------------------------------------------------------------------------------------------------------------------*/

/**********************************************************************************************************************/



/***********************************************************************************************************************
; L O C A L   F U N C T I O N   P R O T O T Y P E S
;---------------------------------------------------------------------------------------------------------------------*/
static void TIMER_1_task_cb(const struct timer_task * const timer_task);
/**********************************************************************************************************************/



/***********************************************************************************************************************
; L O C A L   V A R I A B L E S
;---------------------------------------------------------------------------------------------------------------------*/
static struct timer_descriptor				TIMER_1;
static struct timer_task					TIMER_1_task;
static bool delay_done = false;
/**********************************************************************************************************************/



/***********************************************************************************************************************
; E X P O R T E D   V A R I A B L E S
;---------------------------------------------------------------------------------------------------------------------*/
/**********************************************************************************************************************/



/***********************************************************************************************************************
; L O C A L   F U N C T I O N S
;---------------------------------------------------------------------------------------------------------------------*/
static void TIMER_1_task_cb(const struct timer_task * const timer_task)
{
	delay_done = true;
	timer_stop(&TIMER_1);
	timer_remove_task(&TIMER_1, &TIMER_1_task);
}
/**********************************************************************************************************************/



/***********************************************************************************************************************
; E X P O R T E D   F U N C T I O N S
;---------------------------------------------------------------------------------------------------------------------*/
void StdDelayInit(void)
{	
	_pm_enable_bus_clock(PM_BUS_APBC, TC1);
	//_gclk_enable_channel(TC1_GCLK_ID, CONF_GCLK_TC1_SRC);

	timer_init(&TIMER_1, TC1, _tc_get_timer());
}
/*--------------------------------------------------------------------------------------------------------------------*/
void StdDelayus(uint32_t us)
{
	uint32_t i = 0;
	
	for(i = 0; i<us; i++)
	{
		
	}
	
}

/*--------------------------------------------------------------------------------------------------------------------*/

/**********************************************************************************************************************/
